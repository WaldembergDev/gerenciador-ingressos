{% extends 'base.html' %}
{% load static %}
{% block title %}Todos os ingressos comprados{% endblock %}
{% block content %}
    <a href="{% url 'home' %}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
    <h1 class="text-center mb-4 mt-4">Todos os ingressos vendidos</h1>

    <!-- Filtros -->
    <form action="." method="GET" class="row g-1 mb-3 border rounded p-4">
          <h2 class="text-center col-12">Filtros</h2>
          <div class="col-md-3">
            <label for="inputComprador" class="form-label">Comprador</label>
            <input value="{{ request.GET.inputComprador }}" type="text" class="form-control" name="comprador" id="inputComprador" aria-describedby="Data da Compra">
          </div>
          <div class="col-md-3">
            <label for="inputEvento" class="form-label">Evento</label>
            <input type="text" class="form-control" name="evento" id="inputEvento" aria-describedby="Data da Compra">
          </div>
          <div class="col-md-3">
            <label for="inputDataEvento" class="form-label">Data do Evento</label>
            <input type="date" class="form-control" name="dataEvento" id="inputDataEvento" aria-describedby="Data da Compra">
          </div>
          <div class="col-md-3 d-flex justify-content-center align-items-end gap-1">
            <button type="button" class="btn btn-secondary">Limpar</button>
            <button type="submit" class="btn btn-primary">Buscar</button>
          </div>
    </form>

    <!-- Tabela com os dados-->
    <table class="table table-striped table-hover">
        <thead class="table-dark text-center">
            <tr class="align-middle">
              <th scope="col">Data da Compra</th>
              <th class="d-none d-lg-table-cell" scope="col">Comprador</th>
              <th scope="col">Data do Evento</th>
              <th scope="col">Evento</th>
              <th class="d-none d-lg-table-cell" scope="col">Quantidade</th>
              <th scope="col">Total (R$)</th>
              <th scope="col">Ações</th>
            </tr>
          </thead>
          <tbody class="align-middle text-center">
            {% for historico in page_obj %}
                <tr>
                <th scope="row">{{ historico.data_compra|date:"d/m/Y H:i" }}</th>
                <td class="d-none d-lg-table-cell">{{ historico.cliente.usuario.first_name }}</td>
                <td>{{ historico.ingresso.data_horario|date:"d/m/Y H:i" }}</td>
                <td>{{ historico.titulo }}</td>
                <td class="d-none d-lg-table-cell">{{ historico.quantidade }}</td>
                <td>{{ historico.valor_pago }}</td>
                <td>
                  <a href="{% url 'historico_venda' historico.id %}" class="btn btn-primary">Detalhes</button>
                </td>
                </tr>
            {% empty %}
                <!-- Para pc -->
                <tr class="d-none d-md-table-row text-center">
                  <td colspan="7">Ainda não houve nenhuma compra na plataforma!</td>
                </tr>
                <!-- Para dispositivos móveis -->
                <tr class="d-md-none d-sm-table-row text-center">
                  <td colspan="5">Ainda não houve nenhuma compra na plataforma!</td>
                </tr>
            {% endfor %}
          </tbody>
    </table>

    <!-- Paginação -->
    {% include 'partials/_paginacao.html' %}
{% endblock %}